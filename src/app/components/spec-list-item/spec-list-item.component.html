<div class="spec-item" (click)="openDetails()">
  <!-- Left Section: Image & Play -->
  <div class="item-visual" (click)="playSong($event)">
    <img [src]="spec.imageUrl" [alt]="spec.title" loading="lazy" />
    <div class="play-overlay">
      <i [class]="isCurrentlyPlaying() ? 'fas fa-pause' : 'fas fa-play'"></i>
    </div>
    @if (spec.analytics) {
    <div class="img-analytics">
      <i class="fas fa-play"></i> {{ spec.analytics.playCount }}
    </div>
    }
    <div class="equalizer-bars"><span></span><span></span><span></span><span></span></div>
  </div>

  <!-- Middle Section: Info -->
  <div class="item-content">
    <div class="content-header">
      <h3 class="item-title">{{ spec.title }}</h3>
      @if (spec.genres && spec.genres.length > 0) {
      <span class="genre-badge">{{ spec.genres[0].name }}</span>
      }
      @if (spec.freeMp3Enabled) {
      <span class="free-badge">FREE</span>
      }
    </div>

    <div class="content-meta">
      <div class="meta-pill">
        <i class="fas fa-heartbeat"></i>
        <span>{{ spec.bpm }} BPM</span>
      </div>
      <div class="meta-pill">
        <i class="fas fa-music"></i>
        <span>{{ spec.key }}</span>
      </div>
      @if (spec.duration) {
      <div class="meta-pill">
        <i class="fas fa-clock"></i>
        <span>{{ formatDuration(spec.duration) }}</span>
      </div>
      }
      @if (spec.analytics) {
      <div class="meta-pill glass-stat">
        <i class="fas fa-heart"></i>
        <span>{{ spec.analytics.favoriteCount }}</span>
      </div>
      }
    </div>
  </div>

  <!-- Tags Section (Hidden on mobile) -->
  <div class="item-tags">
    @for (tag of spec.tags.slice(0, 3); track tag) {
    <span class="tag">#{{ tag }}</span>
    }
  </div>

  <!-- Right Section: Price & Actions -->
  <div class="item-actions">
    <div class="secondary-actions">
      <!-- Favorite Button -->
      <button class="action-btn fav-btn" [class.active]="spec.analytics?.isFavorited" (click)="toggleFavorite($event)"
        [disabled]="isFavoriting()">
        <i [class]="spec.analytics?.isFavorited ? 'fas fa-heart' : 'far fa-heart'"></i>
      </button>

      <!-- Free Download Button -->
      @if (spec.freeMp3Enabled) {
      <button class="action-btn download-btn" (click)="downloadFreeMp3($event)" title="Download Free MP3">
        <i class="fas fa-download"></i>
      </button>
      }
    </div>

    <span class="price">â‚¹{{ spec.price }}</span>
    <button class="btn-cart" (click)="addToCart($event)">
      <i class="fas fa-cart-plus"></i>
      <div class="btn-glow"></div>
    </button>
  </div>

  <!-- Background Glow -->
  <div class="item-glow"></div>
</div>