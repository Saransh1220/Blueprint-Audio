<div class="orders-container fade-in">
  <div class="header">
    <h1>Your Orders</h1>
    <div class="controls">
      <button class="btn-export" (click)="exportCSV()">Export CSV</button>
    </div>
  </div>

  @if (isLoading()) {
    <div class="loading-state">
      <div class="spinner"></div>
      <p>Loading orders...</p>
    </div>
  } @else {
    <div class="table-section glass-panel">
      <div class="table-responsive">
        <table>
          <thead>
            <tr>
              <th>Date</th>
              <th>Buyer</th>
              <th>Item</th>
              <th>License</th>
              <th>Amount</th>
              <th>Status</th>
            </tr>
          </thead>
          <tbody>
            @for (order of orders(); track order.id) {
              <tr>
                <td>{{ order.created_at | date: 'mediumDate' }}</td>
                <td>
                  <div class="buyer-info">
                    <span class="name">{{ order.buyer_name }}</span>
                    <span class="email">{{ order.buyer_email }}</span>
                  </div>
                </td>
                <td>{{ order.spec_title }}</td>
                <td>
                  <span class="badge">{{ order.license_type }}</span>
                </td>
                <td>{{ order.amount | currency: order.currency }}</td>
                <td>
                  <span class="status-badge" [class]="order.status.toLowerCase()">
                    {{ order.status }}
                  </span>
                </td>
              </tr>
            }
            @if (orders().length === 0) {
              <tr>
                <td colspan="6" class="text-center">No orders found.</td>
              </tr>
            }
          </tbody>
        </table>
      </div>

      <app-pagination
        [currentPage]="currentPage()"
        [total]="total()"
        [perPage]="limit()"
        (pageChange)="onPageChange($event)"
      >
      </app-pagination>
    </div>
  }
</div>
